#!/bin/sh
set -eu
test -n "${1-}" || {
    find $HOME/x/con -printf "%P "
    echo
    exit
}
! test "$1" = "add" || {
    if expr "$2" : '/.*' &>/dev/null;
    then
        p=
    else
        p="$PWD/"
    fi
    exec ln -s "$p/$2" $HOME/x/con/${3-}
}
t="$HOME/x/con/$1"
a="$t.args"
stargs() {
    ! test -r $a || cat $a
}
shift
args=${*-$(stargs)}
! test -n "$args" || echo "$args" >$a
if command -v "$t"; then
    exec "$t $args"
else
    exec mpv $t "$args"
fi
