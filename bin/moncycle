#!/bin/sh
set -eu
exec>/dev/null 1>&2
dev=i2c-6

lsmod | grep -q i2c_dev || (
    . asroot
    modprobe i2c-dev
    ls -l /dev/$dev
    chgrp wheel /dev/$dev
    chmod g+rw /dev/$dev
    ls -l /dev/$dev
)

name2id() {
    case "$1" in
        dp*) echo 15;;
        dvi*) echo 3;;
        hdmi*) echo 17;;
        *) echo $default;;
    esac
}
exit
default=$(name2id "dp")
ddcutil --bus 6 setvcp 60 $default
name=$(printf "hdmi\ndp\ndvi\n" | rofi -dmenu -p "Video Input")
id=$(name2id $name)
ddcutil --bus 6 setvcp 60 $id
