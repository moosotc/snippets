#!/bin/sh
set -e

wl1='*bladeforums.com;*amediateka.ru;www.fonts-online.ru;192.168.1.64:55555'
wl2='*.avito.ru;*netflix*;*nflx*'
wl="$wl1;$wl2"

false && {
    exec 1>/tmp/chro.out
    exec 2>/tmp/chro.err
} || {
    exec 1>&2 2>/dev/null
}

a() {
    xdotool set_desktop 0 search --sync --onlyvisible --maxdepth 2      \
            --name chromium windowsize 1667 1113 windowactivate
}
a &
pgrep chromium || {
    ps="--proxy-server=socks5://localhost:9050 --proxy-bypass-list=$wl"
    ulimit -s 1024
    exec chromium "$@" $ps
}
